<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.semi.mapper.CityMapper">
	<select id="getTotalCountCity" parameterType="String" resultType="int">
		select count(*) from city_board where city1=#{city1} and city2=#{city2}
	</select>
	<select id="getDetailbycbnum" parameterType="int" resultType="CityBoardDto">
		select * from city_board where cbnum=#{cbnum}
	</select>
	<select id="getDetailbyunum" parameterType="int" resultType="UserDto">
		select * from user where unum=#{unum}
	</select>
	<insert id="insertCity" parameterType="CityBoardDto">
		insert into city_board (subject, unum, cbcontent, cbwriteday, city1, city2, uname, cbphoto)
		value (#{subject}, #{unum}, #{cbcontent}, now(), #{city1}, #{city2}, #{uname}, #{cbphoto})
	</insert>
	<select id="getJoinByunum" resultType="UserDto">
		SELECT *
 		FROM user
  		INNER JOIN city_board ON user.unum = city_board.unum
  		WHERE user.unum = #{unum}
  	</select>
  	<select id="getCityList" parameterType="String" resultType="CityBoardDto">
  		select * from city_board where city1=#{city1} and city2=#{city2} order by cbnum desc;
  	</select>
	<select id="preContent" parameterType="int" resultType="String">
		select subject from city_board where cbnum <![CDATA[<]]> #{cbnum} order by cbnum desc limit 1
	</select>
	<select id="nxtContent" parameterType="int" resultType="String">
		select subject from city_board where cbnum <![CDATA[>]]> #{cbnum} order by cbnum asc limit 1
	</select>
	<select id="preNum" parameterType="int" resultType="String">
		select cbnum from city_board where cbnum <![CDATA[<]]> #{cbnum} order by cbnum desc limit 1
	</select>
	<select id="nxtNum" parameterType="int" resultType="String">
		select cbnum from city_board where cbnum <![CDATA[>]]> #{cbnum} order by cbnum asc limit 1
	</select>
	<insert id="newComment" parameterType="CbReBoardDto">
		insert into cb_reboard (unum,uname,recontent,recontent,cbwriteday,ref,step,depth) 
		value (#{unum},#{uname},#{recontent},now(),#{ref},#{step},#{depth})
	</insert>
	<select id="getTotalComment" parameterType="String" resultType="int">
		select count(*) from cb_reboard
	</select>

</mapper>